/* TresReges / Adam Duncan / 2014-04-29 */
!function(a){var b,c,d=a.event;b=d.special.debouncedresize={setup:function(){a(this).on("resize",b.handler)},teardown:function(){a(this).off("resize",b.handler)},handler:function(a,e){var f=this,g=arguments,h=function(){a.type="debouncedresize",d.dispatch.apply(f,g)};c&&clearTimeout(c),e?h():c=setTimeout(h,b.threshold)},threshold:50}}(jQuery),jQuery.extend(jQuery.easing,{easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}});var AppSettings={DEBUGMODE:!0,scrollPos:0,easing:"easeOutQuad"},Debug={log:function(a){if(AppSettings.DEBUGMODE)if("object"==typeof a)try{console.log(a)}catch(b){}else try{console.log("%c"+a,"color: blue;")}catch(b){}},time:function(a){if(AppSettings.DEBUGMODE)try{console.time(a)}catch(b){}},timeEnd:function(a){if(AppSettings.DEBUGMODE)try{console.timeEnd(a)}catch(b){}}},Layout={sectionSelector:"[data-section]",init:function(){$(Layout.sectionSelector).each(function(){var a=$(this);a.css("height",Utils.viewportHeight)})}},Menu={selector:"[data-menu]",sectionSelector:"[data-section]",sectionArray:[],currentClass:"current",init:function(){Menu.bindClickEvent()},bindClickEvent:function(){$(Menu.selector+" > li > a").on("click",function(a){Utils.smoothScroll($(this).attr("href")),a.preventDefault()})},storeSectionArray:function(){Menu.sectionArray.length=0,$(Menu.sectionSelector).each(function(){var a=$(this),b=a.position().top,c=b+a.outerHeight(),d={top:b,bottom:c};Menu.sectionArray.push(d)})},highlightCurrent:function(){for(var a=0;a<Menu.sectionArray.length;a++)Menu.sectionArray[a].top<=Utils.scrollPos&&Menu.sectionArray[a].bottom-1>=Utils.scrollPos?$("li:nth-child("+(a+1)+") > a",$(Menu.selector)).addClass(Menu.currentClass):$("li:nth-child("+(a+1)+") > a",$(Menu.selector)).removeClass(Menu.currentClass)}},Video={selector:"[data-video]",anchorSelector:"[data-video-anchor]",videoIdAttr:"data-video-id",frameSelector:"[data-video-frame]",frameUrl:"//player.vimeo.com/video/",frameQuery:"?title=0&amp;byline=0&amp;portrait=0&amp;color=bababa&amp;autoplay=1&amp;api=1",init:function(){Video.bindClickEvent()},bindClickEvent:function(){$(Video.anchorSelector).on("click",function(a){var b=$(this).parent();Video.loadVideo(b),a.preventDefault()})},loadVideo:function(a){var b=a.attr(Video.videoIdAttr),c=$(Video.anchorSelector,a).find("img").height();$(Video.frameSelector,a).stop().animate({opacity:0},0).show().find("iframe").attr({src:Video.frameUrl+b+Video.frameQuery,height:c}),Video.showVideo(a)},showVideo:function(a){$(Video.anchorSelector,a).stop().animate({opacity:0},200,function(){$(Video.frameSelector,a).show().stop().animate({opacity:1},200)})},pauseVideo:function(){var a=$(".js_video_frame",".js_showreel")[0],b=$(a).attr("src");""!==b&&$f(a).api("pause")}},Utils={viewportHeight:0,scrollPos:0,bindResizeEvent:function(){$(window).on("load debouncedresize",function(){Utils.resizeEvents()})},resizeEvents:function(){Utils.setViewportHeight(),Layout.init(),Menu.storeSectionArray(),Menu.highlightCurrent()},bindScrollEvent:function(){$(window).on("load scroll",function(){Utils.scrollEvents()})},scrollEvents:function(){Utils.setScrollPos(),Menu.highlightCurrent()},setViewportHeight:function(){Utils.viewportHeight=$(window).height()},setScrollPos:function(){Utils.scrollPos=$(window).scrollTop()},smoothScroll:function(a){$("html, body").stop().animate({scrollTop:$(a).offset().top},600,AppSettings.easing)}},Main={run:function(){Utils.bindResizeEvent(),Utils.bindScrollEvent(),Utils.setViewportHeight(),Layout.init(),Menu.bindClickEvent(),Video.init()}};$(document).ready(Main.run());